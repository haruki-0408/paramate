# テストパターンCSVファイル仕様書

## 概要
`test-all-patterns.csv`は、AWS Systems Manager Parameter Storeの全機能を網羅的にテストするための包括的なテストデータセットです。

## テストカテゴリ

### 1. 基本パラメータタイプ
- **String型**: 通常のテキストパラメータ
- **SecureString型**: KMS暗号化パラメータ（デフォルト/AWS管理キー）
- **StringList型**: セミコロン区切りのリストパラメータ

### 2. パス構造パターン
- ルートレベルパラメータ（`/rootparam`）
- 深いネスト構造（`/test/paths/deep/nested/value`）
- 特殊文字を含むパス（ハイフン、アンダースコア、ドット）
- ダブルスラッシュを含むパス（エラーケース）
- 最大長に近いパラメータ名（499文字）

### 3. 値のパターン
- **JSON形式**: 構造化データ
- **XML形式**: XMLデータ
- **URL形式**: HTTPSエンドポイント
- **Base64エンコード**: バイナリデータの表現
- **複数行テキスト**: 改行を含む値
- **CSV特殊文字**: カンマ、引用符を含む値
- **空文字列**: バリデーションエラーケース
- **数値**: 整数、小数、負の数
- **真偽値**: true/false
- **日時**: ISO8601形式、UNIXタイムスタンプ

### 4. 国際化対応
- 日本語文字
- 絵文字
- 多言語混在（英語、日本語、中国語、ロシア語）

### 5. タグパターン
- タグなし
- 単一タグ
- 複数タグ（5個、10個）
- 特殊文字を含むタグキー（ハイフン、アンダースコア）
- セミコロンを含むタグ値（エッジケース）

### 6. セキュリティ関連
- デフォルトKMS暗号化（キー指定なし）
- AWS管理KMSキー（`alias/aws/ssm`）- 事前準備不要
- 機密情報のマスク表現（クレジットカード、SSN）

### 7. StringListエッジケース
- 単一要素のリスト
- 多数要素のリスト（10個）
- 空要素を含むリスト
- 特殊文字を含むリスト要素

### 8. エッジケース
- 先頭/末尾の空白
- 空白のみの値
- 正規表現特殊文字
- 最大長境界値テスト（パラメータ名: 499文字、説明: 499文字）

## 使用方法

### 1. バリデーションテスト
```bash
scm validate -f templates/test-all-patterns.csv
```

### 2. ドライラン実行
```bash
scm sync -f templates/test-all-patterns.csv --dry-run
```

### 3. 実環境へのアップロード
```bash
# 注意: テスト環境でのみ実行してください
scm sync -f templates/test-all-patterns.csv --path-prefix /test/
```

### 4. テストデータのクリーンアップ
```bash
# AWS CLIを使用してテストパラメータを削除
aws ssm delete-parameters --names $(aws ssm get-parameters-by-path --path /test --recursive --query 'Parameters[].Name' --output text)
```

## テスト項目チェックリスト

### パラメータタイプ
- [x] String
- [x] SecureString（デフォルトKMS）
- [x] SecureString（AWS管理KMS: alias/aws/ssm）
- [x] StringList

### パス構造
- [x] ルートレベルパス（`/rootparam`）
- [x] 基本パス（`/test/basic/string`）
- [x] 深いネスト（5階層）
- [x] 特殊文字（ハイフン、アンダースコア、ドット）
- [x] ダブルスラッシュ（エラーケース）
- [x] 最大長パラメータ名（499文字）

### 値の形式
- [x] プレーンテキスト
- [x] JSON
- [x] XML
- [x] URL
- [x] Base64
- [x] 改行を含むテキスト
- [x] CSV特殊文字（カンマ、引用符）
- [x] 空文字列（エラーケース）
- [x] 数値（整数、小数、負数）
- [x] 真偽値
- [x] 日時形式
- [x] 空白（先頭、末尾、空白のみ）

### タグ
- [x] タグなし
- [x] 単一タグ
- [x] 複数タグ（2個以上）
- [x] 特殊文字を含むタグキー
- [x] セミコロンを含むタグ値

### StringList
- [x] 基本的なリスト（3要素）
- [x] 単一要素のリスト
- [x] 多数要素のリスト（10個）
- [x] 空要素を含むリスト
- [x] 特殊文字を含む要素

### 国際化
- [x] ASCII文字のみ
- [x] 日本語
- [x] 絵文字
- [x] 多言語混在

### エッジケース
- [x] 空白を含む値
- [x] 特殊文字
- [x] 境界値
- [x] CSVパース時の特殊ケース

## 注意事項

1. **環境分離**: このファイルは`/test/`プレフィックスを使用しているため、本番環境では使用しないでください
2. **KMSキー**: `alias/aws/ssm`はAWS管理のデフォルトキーのため、事前準備は不要です
3. **エラーケース**: 空文字列やダブルスラッシュなど、意図的にエラーとなるケースも含まれています
4. **クリーンアップ**: テスト後は必ずパラメータを削除してください
5. **コスト**: 大量のパラメータ作成によりAWS料金が発生する可能性があります

## 統計情報

- **総パラメータ数**: 57個
- **String型**: 46個
- **SecureString型**: 6個（AWS管理キー使用: 1個）
- **StringList型**: 5個
- **最長パラメータ名**: 499文字
- **最長説明文**: 499文字
- **最多タグ数**: 10個
- **エラーケース**: 3個（空文字列、ダブルスラッシュ、ルートレベル）

## 更新履歴

- 2024-01-18: 初版作成
- 2024-01-18: KMSキー要件を簡素化（カスタムキーを1つに削減、AWS管理キーを使用）
- 2024-01-18: 追加パターンを実装（CSV特殊文字、XML、空要素リスト、タグエッジケース等）